<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Event RSVP</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f4f6f8; --muted:#7b8694; --accent:#0a66c2; --accent-2:#1b9df0;
      --radius:14px; --shadow:0 6px 24px rgba(16,24,40,0.08);
      --success:#1f9d55; --danger:#d64545;
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{
      margin:0;font-family:"Inter",system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      background:
        radial-gradient(800px 400px at 10% 10%, rgba(26,94,255,0.04), transparent 10%),
        var(--bg);
      display:flex;align-items:center;justify-content:center;padding:48px 20px;color:#0f1724;
    }
    .site{
      width:100%;max-width:880px;
    }
    header, footer{display:flex;justify-content:space-between;align-items:center;margin-bottom:18px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.9), #fff);padding:28px;border-radius:var(--radius);box-shadow:var(--shadow)}
    form{display:grid;grid-template-columns:1fr 320px;gap:18px;align-items:start}
    @media (max-width:760px){ form{grid-template-columns:1fr}}
    label{display:flex;flex-direction:column;gap:8px;font-size:13px}
    input[type="text"], select{
      padding:12px 14px;border-radius:10px;border:1px solid #e6e9ee;background:transparent;font-size:15px;outline:none;
    }
    input[type="text"]:focus, select:focus{box-shadow:0 6px 20px rgba(10,102,194,0.08);border-color:rgba(10,102,194,0.9)}
    .aside{padding:18px;border-radius:10px;background:linear-gradient(180deg, rgba(10,102,194,0.04), rgba(255,255,255,0.2));border:1px solid rgba(12,45,95,0.04)}
    .actions{display:flex;gap:12px;justify-content:flex-end}
    .btn{padding:12px 16px;border-radius:10px;font-weight:600;cursor:pointer;border:0}
    .primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#fff;box-shadow:0 10px 30px rgba(13,74,148,0.12)}
    .ghost{background:transparent;border:1px solid #e6eefc;color:var(--accent)}
    .help{font-size:13px;color:var(--muted)}
    footer{margin-top:16px;color:var(--muted);font-size:13px}

    /* Notices */
    .notice{
      border-radius:10px;
      padding:12px 14px;
      margin-bottom:12px;
      display:flex;
      gap:12px;
      align-items:flex-start;
      font-size:14px;
    }
    .notice.success{
      background:linear-gradient(90deg, rgba(31,157,85,0.08), rgba(255,255,255,0.4));
      border:1px solid rgba(31,157,85,0.12);
      color:var(--success);
    }
    .notice.error{
      background:linear-gradient(90deg, rgba(214,69,69,0.06), rgba(255,255,255,0.4));
      border:1px solid rgba(214,69,69,0.12);
      color:var(--danger);
    }
    .notice .muted{color:var(--muted);font-size:13px}
    .spinner{
      width:18px;height:18px;border-radius:50%;border:2px solid rgba(0,0,0,0.08);border-top-color:rgba(10,102,194,0.9);animation:spin .9s linear infinite;
    }
    @keyframes spin{ to { transform: rotate(360deg); } }
  </style>
</head>
<body>
  <div class="site">
    <header>
      <div class="brand" role="banner">
        <div class="logo" aria-hidden="true">WS</div>
        <div>
          <div style="font-weight:600">Wine Specialists</div>
          <div class="help">Event RSVP</div>
        </div>
      </div>
      <nav aria-label="Top actions"><a href="#" class="help">Support</a></nav>
    </header>

    <main class="card" role="main" aria-labelledby="title">
      <h2 id="title" style="margin:0 0 8px">RSVP — choose your event & meal</h2>
      <p class="help" style="margin:0 0 16px">Select the event type and preferred food category below.</p>

      <!-- form: JS will handle submit and show messages -->
      <form id="rsvpForm" action="https://n8n.ksquareservices.com/webhook-test/wine" method="post" novalidate>
        <div>
          <!-- live region for feedback -->
          <div id="formMessage" aria-live="polite" aria-atomic="true"></div>

          <label for="attendee">Full name
            <input id="attendee" name="name" type="text" placeholder="Jane Doe" autocomplete="name" required>
          </label>

          <label for="event_type">Event type
            <select id="event_type" name="event_type" required>
              <option value="" disabled selected hidden>Choose an event</option>
              <option value="dinner">Dinner</option>
              <option value="lunch">Lunch</option>
              <option value="brunch">Brunch</option>
              <option value="appero">Appero</option>
            </select>
          </label>

          <label for="food_type">Type of food
            <select id="food_type" name="food_type" required>
              <option value="" disabled selected hidden>Choose food type</option>
              <option value="meat">Meat</option>
              <option value="seafood">Sea food</option>
              <option value="vegetarian">Vegetarian</option>
            </select>
          </label>

          <div class="actions" style="margin-top:12px">
            <button type="reset" class="btn ghost">Reset</button>
            <button id="submitBtn" type="submit" class="btn primary">Find the best wine</button>
          </div>
        </div>

        <aside class="aside" aria-label="Info">
          <strong>Details</strong>
          <p class="help" style="margin:6px 0 0">We'll confirm availability and any dietary accommodations after submission.</p>
          <small class="help" style="margin-top:auto">By submitting you agree to our <a href="#" class="help">privacy policy</a>.</small>
        </aside>
      </form>
    </main>

    <footer>
      <div>© <strong>Wine Specialists</strong> 2025</div>
      <div style="display:flex;gap:12px"><a class="help" href="#">Privacy</a><a class="help" href="#">Terms</a></div>
    </footer>
  </div>

  <script>
    (function () {
      const form = document.getElementById('rsvpForm');
      const submitBtn = document.getElementById('submitBtn');
      const msgWrap = document.getElementById('formMessage');
      const endpoint = form.getAttribute('action');

      function showMessage(type, title, text) {
        msgWrap.innerHTML = '';
        const el = document.createElement('div');
        el.className = 'notice ' + (type === 'success' ? 'success' : 'error');
        el.innerHTML = '<div style="display:flex;align-items:center;"><span class="spinner" aria-hidden="true" style="display:none"></span></div><div><strong style="display:block;margin-bottom:4px;">' + title + '</strong><div class="muted">' + text + '</div></div>';
        msgWrap.appendChild(el);
        // hide spinner unless loading state set separately
      }

      function setLoading(loading) {
        if (loading) {
          submitBtn.disabled = true;
          submitBtn.dataset.orig = submitBtn.textContent;
          submitBtn.innerHTML = '<span class="spinner" aria-hidden="true"></span> Sending...';
        } else {
          submitBtn.disabled = false;
          submitBtn.textContent = submitBtn.dataset.orig || 'Find the best wine';
        }
      }

      async function postForm(fd) {
        // send as FormData to the endpoint
        const controller = new AbortController();
        const timeout = setTimeout(() => controller.abort(), 15000);
        try {
          const res = await fetch(endpoint, {
            method: 'POST',
            body: fd,
            signal: controller.signal,
          });
          clearTimeout(timeout);
          return res;
        } catch (err) {
          clearTimeout(timeout);
          throw err;
        }
      }

      form.addEventListener('submit', async function (e) {
        e.preventDefault();

        // Basic front-end validation
        if (!form.checkValidity()) {
          form.reportValidity();
          return;
        }

        setLoading(true);
        showMessage('info', 'Sending…', 'Please wait while we send your selection.');

        const fd = new FormData(form);

        try {
          const res = await postForm(fd);

          if (res.ok) {
            // success
            msgWrap.innerHTML = '';
            const success = document.createElement('div');
            success.className = 'notice success';
            success.innerHTML = '<div style="display:flex;align-items:center;"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div><div><strong style="display:block;margin-bottom:4px;">Success — data sent to the search engine</strong><div class="muted">Thanks. We received your choices and will follow up shortly with confirmation and recommendations.</div></div>';
            msgWrap.appendChild(success);

            // Optionally clear the form after a short delay (commented to keep user's data if you prefer)
            // setTimeout(() => form.reset(), 900);

          } else {
            // server returned an error status
            msgWrap.innerHTML = '';
            const err = document.createElement('div');
            err.className = 'notice error';
            err.innerHTML = '<div style="display:flex;align-items:center;"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 9v4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M21 12A9 9 0 1 0 3 12a9 9 0 0 0 18 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div><div><strong style="display:block;margin-bottom:4px;">Error — submission failed</strong><div class="muted">Sorry, there was a problem sending your data. Please try again later.</div></div>';
            msgWrap.appendChild(err);
          }

        } catch (err) {
          // network or other error
          console.error(err);
          msgWrap.innerHTML = '';
          const errMsg = document.createElement('div');
          errMsg.className = 'notice error';
          errMsg.innerHTML = '<div style="display:flex;align-items:center;"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 9v4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 17h.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M21 12A9 9 0 1 0 3 12a9 9 0 0 0 18 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div><div><strong style="display:block;margin-bottom:4px;">Error — submission failed</strong><div class="muted">Sorry, there was a problem sending your data. Please check your connection and try again.</div></div>';
          msgWrap.appendChild(errMsg);
        } finally {
          setLoading(false);
        }
      });
    })();
  </script>
</body>

</html>
